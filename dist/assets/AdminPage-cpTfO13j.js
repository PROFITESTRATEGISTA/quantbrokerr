import{j as e,r as n,s as u,R as le}from"./index-Bsf3mvx-.js";import{c as J,U as ae,a as be,T as xe,C as ne,X as se,b as ie,M as Me,e as Ke,P as nt,L as it}from"./Layout-CXUI3X8L.js";import{D as oe}from"./dollar-sign-DnZwR5e-.js";import{B as Pe}from"./bar-chart-3-DlwhO4sx.js";import{R as ot,B as ct,C as ze,X as Be,Y as Oe,T as Ie,b as dt,L as xt,a as mt,F as ut,P as _e,d as he,A as ce,S as qe}from"./BarChart-Cw71silj.js";import{T as Fe}from"./trending-down-ukfOfanE.js";import{F as Xe}from"./file-text-Dr0VdL-O.js";import{S as ht}from"./shield-D9UTA1ww.js";import{E as Ye}from"./external-link-BeCRwisN.js";/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=J("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=J("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=J("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=J("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=J("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=J("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=J("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=J("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=J("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=J("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=J("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=J("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=J("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=J("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=J("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),vt=()=>e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Painel Administrativo"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Gerencie resultados, finanças e estatísticas"})]}),Nt=({activeTab:x,onTabChange:T})=>{const h=[{id:"financial",label:"Financeiro",icon:oe,description:"Gestão de custos e despesas"},{id:"contracts",label:"Contratos",icon:me,description:"Contratos de clientes"},{id:"users",label:"Central de Usuários",icon:ae,description:"Gerenciamento de usuários"},{id:"waitlist",label:"Fila de Espera & Formulários",icon:be,description:"Controle de inscrições e formulários"},{id:"leads",label:"Leads Totais",icon:we,description:"Leads únicos de todas as fontes"},{id:"suppliers",label:"Fornecedores",icon:xe,description:"Contratos de fornecedores"}];return e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 mb-6",children:e.jsx("div",{className:"flex space-x-1 p-1",children:h.map(L=>e.jsxs("button",{onClick:()=>T(L.id),className:`flex items-center px-4 py-2 rounded-md text-sm font-medium transition-colors ${x===L.id?"bg-blue-600 text-white shadow-sm":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"}`,title:L.description,children:[e.jsx(L.icon,{className:"h-4 w-4 mr-2"}),L.label]},L.id))})})},wt=()=>{const[x,T]=n.useState("bar"),[h,L]=n.useState("revenue"),[b,k]=n.useState([]),[M,j]=n.useState([]),[v,N]=n.useState([]),[d,z]=n.useState([]),[F,f]=n.useState([]),[q,R]=n.useState(!0);n.useEffect(()=>{w()},[]);const w=async()=>{try{R(!0),await Promise.all([G(),Y(),O(),B(),W()])}catch(p){console.error("Error fetching data:",p)}finally{R(!1)}},G=async()=>{try{const{data:p,error:C}=await u.from("financial_costs").select("*").order("cost_date",{ascending:!0});if(C)throw C;k(p||[])}catch(p){console.error("Error fetching costs:",p)}},Y=async()=>{try{const{data:p,error:C}=await u.from("client_contracts").select("*").eq("is_active",!0).order("created_at",{ascending:!0});if(C)throw C;j(p||[])}catch(p){console.error("Error fetching contracts:",p)}},O=async()=>{try{const{data:p,error:C}=await u.from("supplier_contracts").select("id, monthly_value, contract_start, is_active, created_at").eq("is_active",!0).order("created_at",{ascending:!0});if(C)throw C;N(p||[])}catch(p){console.error("Error fetching supplier contracts:",p)}},B=async()=>{try{const{data:p,error:C}=await u.from("waitlist_entries").select("*").order("created_at",{ascending:!0});if(C)throw C;z(p||[])}catch(p){console.error("Error fetching waitlist entries:",p)}},W=async()=>{try{const{data:p,error:C}=await u.from("user_profiles").select("id, email, full_name, created_at, is_active").order("created_at",{ascending:!0});if(C)throw C;f(p||[])}catch(p){console.error("Error fetching users:",p)}},o=Array.from({length:12},(C,P)=>{const A=new Date;return A.setMonth(A.getMonth()-(11-P)),{month:A.toLocaleDateString("pt-BR",{month:"short",year:"numeric"}),monthKey:`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}`}}).map(({month:C,monthKey:P})=>{let A=0,m=0,y=0,I=0,g=0,D=0,Z=0,ee=0;switch(h){case"users":A=F.filter(r=>{const i=new Date(r.created_at);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P}).length;break;case"clients":A=M.filter(r=>new Date(r.created_at)<=new Date(P+"-31")).length;break;case"revenue":A=M.filter(r=>{const i=new Date(r.created_at);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P}).reduce((r,i)=>r+i.monthly_value,0);break;case"costs":A=b.filter(r=>{const i=new Date(r.cost_date);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P}).reduce((r,i)=>r+i.amount,0);break;case"profit":m=M.filter(r=>new Date(r.created_at)<=new Date(P+"-31")).reduce((r,i)=>r+i.monthly_value,0),y=b.filter(r=>{const i=new Date(r.cost_date);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P}).reduce((r,i)=>r+i.amount,0),I=v.filter(r=>new Date(r.created_at)<=new Date(P+"-31")).reduce((r,i)=>r+i.monthly_value,0),A=m-y-I;break;case"cal":g=b.filter(r=>{const i=new Date(r.cost_date);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P&&r.category==="marketing"}).reduce((r,i)=>r+i.amount,0);const c=F.filter(r=>{const i=new Date(r.created_at);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P}),E=d.filter(r=>{const i=new Date(r.created_at);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P});D=new Set([...c.map(r=>r.email.toLowerCase()),...E.map(r=>r.email.toLowerCase())]).size,A=D>0?g/D:0;break;case"cac":g=b.filter(r=>{const i=new Date(r.cost_date);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P&&r.category==="marketing"}).reduce((r,i)=>r+i.amount,0),Z=M.filter(r=>{const i=new Date(r.created_at);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P}).length,A=Z>0?g/Z:0;break;case"churn":const a=M.filter(r=>new Date(r.created_at)<new Date(P+"-01")).length;ee=M.filter(r=>{if(!r.updated_at||r.is_active)return!1;const i=new Date(r.updated_at);return`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}`===P}).length,A=a>0?ee/a*100:0;break}return{month:C,value:A,formattedValue:h==="users"||h==="clients"?A.toString():h==="churn"?`${A.toFixed(1)}%`:`R$ ${A.toLocaleString("pt-BR",{minimumFractionDigits:2})}`}}),l=(()=>{switch(h){case"users":return{title:"Crescimento de Usuários",color:"#3b82f6",icon:ae,unit:"usuários"};case"clients":return{title:"Evolução de Clientes",color:"#3b82f6",icon:me,unit:"clientes"};case"revenue":return{title:"Receita Mensal",color:"#22c55e",icon:oe,unit:"R$"};case"costs":return{title:"Custos Operacionais",color:"#ef4444",icon:Fe,unit:"R$"};case"profit":return{title:"Lucro Líquido Mensal",color:"#8b5cf6",icon:xe,unit:"R$"};case"cal":return{title:"CAL - Custo por Lead",color:"#eab308",icon:we,unit:"R$"};case"cac":return{title:"CAC - Custo por Cliente",color:"#f97316",icon:jt,unit:"R$"};case"churn":return{title:"Taxa de Churn",color:"#ef4444",icon:Fe,unit:"%"};case"comparison":return{title:"Comparativo Financeiro",color:"#6b7280",icon:Pe,unit:""};default:return{title:"Receita Mensal",color:"#22c55e",icon:oe,unit:"R$"}}})(),_=({active:p,payload:C,label:P})=>{if(p&&C&&C.length){const A=C[0];return e.jsxs("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-medium text-gray-900",children:P}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l.title,": ",e.jsx("span",{className:"font-bold",style:{color:l.color},children:A.payload.formattedValue})]})]})}return null},$=()=>x==="bar"?e.jsxs(ct,{data:o,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(ze,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(Be,{dataKey:"month",stroke:"#64748b",fontSize:12}),e.jsx(Oe,{stroke:"#64748b",fontSize:12,tickFormatter:p=>h==="clients"?p.toString():h==="churn"?`${p.toFixed(1)}%`:`R$ ${(p/1e3).toFixed(0)}k`}),e.jsx(Ie,{content:e.jsx(_,{})}),e.jsx(dt,{dataKey:"value",fill:l.color,radius:[4,4,0,0]})]}):e.jsxs(xt,{data:o,margin:{top:5,right:30,left:20,bottom:5},children:[e.jsx(ze,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(Be,{dataKey:"month",stroke:"#64748b",fontSize:12}),e.jsx(Oe,{stroke:"#64748b",fontSize:12,tickFormatter:p=>h==="clients"?p.toString():h==="churn"?`${p.toFixed(1)}%`:`R$ ${(p/1e3).toFixed(0)}k`}),e.jsx(Ie,{content:e.jsx(_,{})}),e.jsx(mt,{type:"monotone",dataKey:"value",stroke:l.color,strokeWidth:3,dot:{fill:l.color,strokeWidth:2,r:4},activeDot:{r:6,stroke:l.color,strokeWidth:2}})]});return q?e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-64 bg-gray-200 rounded"})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center mb-6 gap-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(l.icon,{className:"h-6 w-6 text-gray-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:l.title})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Dados:"}),e.jsxs("select",{value:h,onChange:p=>L(p.target.value),className:"bg-gray-100 border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"revenue",children:"Receita"}),e.jsx("option",{value:"profit",children:"Lucro Líquido Mensal"}),e.jsx("option",{value:"costs",children:"Custos Operacionais"}),e.jsx("option",{value:"clients",children:"Evolução de Clientes"}),e.jsx("option",{value:"cal",children:"CAL - Custo por Lead"}),e.jsx("option",{value:"cac",children:"CAC - Custo por Cliente"}),e.jsx("option",{value:"churn",children:"Taxa de Churn"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Tipo:"}),e.jsx("button",{onClick:()=>T(x==="bar"?"line":"bar"),className:`flex items-center gap-2 px-3 py-2 rounded-lg transition-colors ${x==="bar"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:x==="bar"?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Barras"})]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Linha"})]})})]})]})]}),e.jsx("div",{className:"h-80",children:e.jsx(ot,{width:"100%",height:"100%",children:$()})}),e.jsxs("div",{className:"mt-6 grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold",style:{color:l.color},children:[o.reduce((p,C)=>p+C.value,0).toLocaleString("pt-BR",{minimumFractionDigits:h==="clients"||h==="churn"?0:2}),h==="churn"?"%":""]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Total ",h==="clients"?"Clientes":h==="revenue"?"Receita":h==="profit"?"Lucro":h==="cal"?"CAL":h==="cac"?"CAC":h==="churn"?"Churn":"Custos"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[(o.reduce((p,C)=>p+C.value,0)/Math.max(o.filter(p=>p.value>0).length,1)).toLocaleString("pt-BR",{minimumFractionDigits:h==="clients"||h==="churn"?0:2}),h==="churn"?"%":""]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Média Mensal"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:[Math.max(...o.map(p=>p.value)).toLocaleString("pt-BR",{minimumFractionDigits:h==="clients"||h==="churn"?0:2}),h==="churn"?"%":""]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Maior Valor"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold text-orange-600",children:o.filter(p=>p.value>0).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Meses Ativos"})]})]})]})},_t=({costs:x})=>{const[T,h]=le.useState([]),[L,b]=le.useState([]),[k,M]=le.useState([]),[j,v]=le.useState([]),[N,d]=le.useState([]),[z,F]=le.useState(!0);le.useEffect(()=>{f()},[]);const f=async()=>{try{const[g,D,Z,ee,c]=await Promise.all([u.from("client_contracts").select("*").eq("is_active",!0),u.from("supplier_contracts").select("*").eq("is_active",!0),u.from("waitlist_entries").select("*"),u.from("user_profiles").select("id, email, created_at"),u.from("consultation_forms").select("id, email, created_at")]);h(g.data||[]),b(D.data||[]),M(Z.data||[]),v(ee.data||[]),d(c.data||[])}catch(g){console.error("Error fetching contracts:",g)}finally{F(!1)}},q=new Date().getMonth(),R=new Date().getFullYear(),w=x.filter(g=>{const D=new Date(g.cost_date);return D.getMonth()===q&&D.getFullYear()===R}),G=x.filter(g=>g.is_recurring),Y=x.filter(g=>!g.is_recurring);w.reduce((g,D)=>g+D.amount,0);const O=L.reduce((g,D)=>g+D.monthly_value,0),B=G.reduce((g,D)=>g+D.amount,0)+O;Y.reduce((g,D)=>g+D.amount,0);const W=x.reduce((g,D)=>g+D.amount,0),U=T.reduce((g,D)=>g+D.monthly_value,0),o=U-W-O,s=x.filter(g=>g.category==="marketing").reduce((g,D)=>g+D.amount,0),_=new Set([...j.map(g=>g.email.toLowerCase()),...k.map(g=>g.email.toLowerCase()),...N.map(g=>g.email.toLowerCase())]).size,$=_>0?s/_:0,p=T.filter(g=>{const D=new Date(g.created_at);return D.getMonth()===q&&D.getFullYear()===R}).length,C=p>0?s/p:0,[P,A]=le.useState([]);le.useEffect(()=>{(async()=>{try{const{data:D}=await u.from("client_contracts").select("*");A(D||[])}catch(D){console.error("Error fetching all contracts:",D)}})()},[]);const m=P.filter(g=>!g.is_active).length,y=P.length,I=y>0?m/y*100:0;return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Receita Mensal"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",U.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Custos Fornecedores"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:["R$ ",O.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Custos Operacionais"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",W.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Custos Recorrentes"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["R$ ",B.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-2 border-purple-200",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:`h-8 w-8 ${o>=0?"text-purple-600":"text-red-600"}`}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Lucro Líquido Mensal"}),e.jsxs("p",{className:`text-2xl font-bold ${o>=0?"text-purple-600":"text-red-600"}`,children:["R$ ",o.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"h-8 w-8 text-indigo-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Alavancagem Média por Cliente"}),e.jsxs("p",{className:"text-2xl font-bold text-indigo-600",children:[T.length>0?(T.reduce((g,D)=>g+(D.leverage_multiplier||1),0)/T.length).toFixed(1):"0.0","x"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-yellow-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-8 w-8 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"CAL (Custo por Lead)"}),e.jsxs("p",{className:"text-2xl font-bold text-yellow-600",children:["R$ ",$.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[_," leads • R$ ",s.toLocaleString("pt-BR",{minimumFractionDigits:2})," marketing"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-orange-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(xe,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"CAC (Custo por Cliente)"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:["R$ ",C.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[p," novos clientes este mês"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6 border-l-4 border-red-500",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Fe,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taxa de Churn"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[I.toFixed(1),"%"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[m," de ",y," contratos cancelados"]})]})]})})]})},Ct=({searchTerm:x,setSearchTerm:T,categoryFilter:h,setCategoryFilter:L,recurringFilter:b,setRecurringFilter:k,dateFilter:M,setDateFilter:j})=>{const v=[{value:"all",label:"Todas as Categorias"},{value:"operacional",label:"Operacional"},{value:"marketing",label:"Marketing"},{value:"tecnologia",label:"Tecnologia"},{value:"pessoal",label:"Pessoal"},{value:"infraestrutura",label:"Infraestrutura"},{value:"outros",label:"Outros"}];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ut,{className:"h-5 w-5 mr-2"}),"Filtros"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ft,{className:"h-4 w-4 inline mr-1"}),"Buscar"]}),e.jsx("input",{type:"text",value:x,onChange:N=>T(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Buscar por descrição..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),e.jsx("select",{value:h,onChange:N=>L(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:v.map(N=>e.jsx("option",{value:N.value,children:N.label},N.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo"}),e.jsxs("select",{value:b,onChange:N=>k(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Tipos"}),e.jsx("option",{value:"recurring",children:"Recorrentes"}),e.jsx("option",{value:"one-time",children:"Únicos"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ne,{className:"h-4 w-4 inline mr-1"}),"Mês/Ano"]}),e.jsx("input",{type:"month",value:M,onChange:N=>j(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})},kt=({isOpen:x,onClose:T,onSubmit:h,loading:L})=>{var N;const[b,k]=n.useState({description:"",category:"operacional",amount:"",cost_date:new Date().toISOString().split("T")[0],is_recurring:!1}),M=[{value:"operacional",label:"Operacional",icon:"⚙️"},{value:"marketing",label:"Marketing",icon:"📢"},{value:"tecnologia",label:"Tecnologia",icon:"💻"},{value:"pessoal",label:"Pessoal",icon:"👥"},{value:"infraestrutura",label:"Infraestrutura",icon:"🏗️"},{value:"outros",label:"Outros",icon:"📋"}],j=d=>{d.preventDefault(),!(!b.description||!b.amount||!b.cost_date)&&(h({description:b.description,category:b.category,amount:parseFloat(b.amount),cost_date:b.cost_date,is_recurring:b.is_recurring}),k({description:"",category:"operacional",amount:"",cost_date:new Date().toISOString().split("T")[0],is_recurring:!1}))},v=(d,z)=>{k(F=>({...F,[d]:z}))};return x?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Novo Custo Financeiro"}),e.jsx("button",{onClick:T,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:j,className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Xe,{className:"h-4 w-4 inline mr-1"}),"Descrição do Custo *"]}),e.jsx("input",{type:"text",value:b.description,onChange:d=>v("description",d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Licença software, Marketing digital, etc.",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(bt,{className:"h-4 w-4 inline mr-1"}),"Categoria *"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:M.map(d=>e.jsxs("button",{type:"button",onClick:()=>v("category",d.value),className:`p-3 border-2 rounded-lg transition-all text-left ${b.category===d.value?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"text-lg mb-1",children:d.icon}),e.jsx("div",{className:"text-sm font-medium",children:d.label})]},d.value))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(oe,{className:"h-4 w-4 inline mr-1"}),"Valor (R$) *"]}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:b.amount,onChange:d=>v("amount",d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0,00",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ne,{className:"h-4 w-4 inline mr-1"}),"Data do Custo *"]}),e.jsx("input",{type:"date",value:b.cost_date,onChange:d=>v("cost_date",d.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:b.is_recurring,onChange:d=>v("is_recurring",d.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded mr-3"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Je,{className:"h-4 w-4 text-blue-600 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Este é um custo recorrente (mensal)"})]})]}),e.jsx("p",{className:"text-xs text-blue-700 mt-2 ml-7",children:"Marque esta opção se este custo se repete mensalmente (ex: assinaturas, salários)"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Resumo do Custo"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Descrição:"}),e.jsx("span",{className:"font-medium",children:b.description||"Não informado"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Categoria:"}),e.jsx("span",{className:"font-medium",children:(N=M.find(d=>d.value===b.category))==null?void 0:N.label})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Valor:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["R$ ",b.amount?parseFloat(b.amount).toLocaleString("pt-BR",{minimumFractionDigits:2}):"0,00"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Tipo:"}),e.jsx("span",{className:`font-medium ${b.is_recurring?"text-purple-600":"text-orange-600"}`,children:b.is_recurring?"Recorrente":"Único"})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",disabled:L||!b.description||!b.amount,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:L?"Adicionando...":"Adicionar Custo"}),e.jsx("button",{type:"button",onClick:T,className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})}):null},St=({costs:x,onEdit:T,onDelete:h})=>{const[L,b]=n.useState("cost_date"),[k,M]=n.useState("desc"),j=f=>({operacional:"Operacional",marketing:"Marketing",tecnologia:"Tecnologia",pessoal:"Pessoal",infraestrutura:"Infraestrutura",outros:"Outros"})[f]||f,v=f=>({operacional:"⚙️",marketing:"📢",tecnologia:"💻",pessoal:"👥",infraestrutura:"🏗️",outros:"📋"})[f]||"📋",N=f=>({operacional:"bg-blue-100 text-blue-800",marketing:"bg-green-100 text-green-800",tecnologia:"bg-purple-100 text-purple-800",pessoal:"bg-yellow-100 text-yellow-800",infraestrutura:"bg-orange-100 text-orange-800",outros:"bg-gray-100 text-gray-800"})[f]||"bg-gray-100 text-gray-800",d=f=>{L===f?M(k==="asc"?"desc":"asc"):(b(f),M("desc"))},z=[...x].sort((f,q)=>{let R=f[L],w=q[L];return typeof R=="string"&&typeof w=="string"&&(R=R.toLowerCase(),w=w.toLowerCase()),R<w?k==="asc"?-1:1:R>w?k==="asc"?1:-1:0}),F=({field:f,children:q})=>e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>d(f),children:e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("span",{children:q}),L===f&&e.jsx("span",{className:"text-blue-500",children:k==="asc"?"↑":"↓"})]})});return x.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(oe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum custo encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Os custos financeiros aparecerão aqui conforme forem adicionados"})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Lista de Custos (",x.length," ",x.length===1?"item":"itens",")"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gerencie todos os custos financeiros da empresa"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx(F,{field:"description",children:"Descrição"}),e.jsx(F,{field:"category",children:"Categoria"}),e.jsx(F,{field:"amount",children:"Valor"}),e.jsx(F,{field:"cost_date",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:z.map(f=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:f.description}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Criado em ",new Date(f.created_at).toLocaleDateString("pt-BR")]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${N(f.category)}`,children:[e.jsx("span",{className:"mr-1",children:v(f.category)}),j(f.category)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm font-bold text-gray-900",children:["R$ ",f.amount.toLocaleString("pt-BR",{minimumFractionDigits:2})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:new Date(f.cost_date).toLocaleDateString("pt-BR")}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(f.cost_date).toLocaleDateString("pt-BR",{weekday:"long"})})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"flex items-center",children:f.is_recurring?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:[e.jsx(Je,{className:"h-3 w-3 mr-1"}),"Recorrente"]}):e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[e.jsx(gt,{className:"h-3 w-3 mr-1"}),"Único"]})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>T(f),className:"text-blue-600 hover:text-blue-800 transition-colors",title:"Editar custo",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{confirm(`Tem certeza que deseja excluir o custo "${f.description}"?`)&&h(f.id)},className:"text-red-600 hover:text-red-800 transition-colors",title:"Excluir custo",children:e.jsx(pe,{className:"h-4 w-4"})})]})})]},f.id))})]})})]})},He=()=>{const[x,T]=n.useState([]),[h,L]=n.useState([]),[b,k]=n.useState(!0),[M,j]=n.useState(null),[v,N]=n.useState(null),[d,z]=n.useState(!1),[F,f]=n.useState(null),[q,R]=n.useState(!1),[w,G]=n.useState(""),[Y,O]=n.useState("all"),[B,W]=n.useState("all"),[U,o]=n.useState("");n.useEffect(()=>{s()},[]),n.useEffect(()=>{l()},[x,w,Y,B,U]);const s=async()=>{try{k(!0);const{data:m,error:y}=await u.from("financial_costs").select("*").order("cost_date",{ascending:!1});if(y)throw y;T(m||[])}catch(m){j(m.message)}finally{k(!1)}},l=()=>{let m=[...x];w&&(m=m.filter(y=>y.description.toLowerCase().includes(w.toLowerCase()))),Y!=="all"&&(m=m.filter(y=>y.category===Y)),B!=="all"&&(m=m.filter(y=>B==="recurring"?y.is_recurring:!y.is_recurring)),U&&(m=m.filter(y=>{const I=new Date(y.cost_date),g=new Date(U+"-01");return I.getMonth()===g.getMonth()&&I.getFullYear()===g.getFullYear()})),L(m)},_=async m=>{try{R(!0),j(null);const{error:y}=await u.from("financial_costs").insert(m);if(y)throw y;N("Custo financeiro adicionado com sucesso!"),z(!1),s()}catch(y){j(y.message)}finally{R(!1)}},$=m=>{f(m),z(!0)},p=async m=>{if(F)try{R(!0),j(null);const{error:y}=await u.from("financial_costs").update(m).eq("id",F.id);if(y)throw y;N("Custo financeiro atualizado com sucesso!"),z(!1),f(null),s()}catch(y){j(y.message)}finally{R(!1)}},C=async m=>{try{j(null);const{error:y}=await u.from("financial_costs").delete().eq("id",m);if(y)throw y;N("Custo financeiro excluído com sucesso!"),s()}catch(y){j(y.message)}},P=m=>{F?p(m):_(m)},A=()=>{z(!1),f(null),j(null),N(null)};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"h-8 w-8 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Gestão Financeira"}),e.jsx("p",{className:"text-gray-600",children:"Controle completo de custos e despesas da empresa"})]})]}),e.jsxs("button",{onClick:()=>z(!0),className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),"Novo Custo"]})]}),M&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 mr-2"}),M,e.jsx("button",{onClick:()=>j(null),className:"ml-auto text-red-500 hover:text-red-700",children:"×"})]}),v&&e.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),v,e.jsx("button",{onClick:()=>N(null),className:"ml-auto text-green-500 hover:text-green-700",children:"×"})]}),e.jsx(_t,{costs:x}),e.jsx(wt,{}),e.jsx(Ct,{searchTerm:w,setSearchTerm:G,categoryFilter:Y,setCategoryFilter:O,recurringFilter:B,setRecurringFilter:W,dateFilter:U,setDateFilter:o}),e.jsx(St,{costs:h,onEdit:$,onDelete:C}),e.jsx(kt,{isOpen:d,onClose:A,onSubmit:P,loading:q})]})},Dt=()=>{var Ae,Te,$e;const[x,T]=n.useState([]),[h,L]=n.useState(!0),[b,k]=n.useState(null),[M,j]=n.useState({}),[v,N]=n.useState(!1),[d,z]=n.useState(null),[F,f]=n.useState(""),[q,R]=n.useState(!1),[w,G]=n.useState(null),[Y,O]=n.useState(""),[B,W]=n.useState(!1),[U,o]=n.useState(null),[s,l]=n.useState(null),[_,$]=n.useState(null),[p,C]=n.useState(null),[P,A]=n.useState(!1),[m,y]=n.useState({user_id:"",plan_type:"bitcoin",billing_period:"monthly",monthly_value:0,leverage_multiplier:1,referral_partner_id:"",contract_start:new Date().toISOString().split("T")[0],contract_end:""}),[I,g]=n.useState([]),[D,Z]=n.useState([]),[ee,c]=n.useState(!1),[E,te]=n.useState(!1);n.useRef({}),n.useEffect(()=>{P&&(a(),r())},[P]),n.useEffect(()=>{if(m.contract_start){const t=new Date(m.contract_start);let S=new Date(t);m.billing_period==="semiannual"?S.setMonth(S.getMonth()+6):m.billing_period==="annual"?S.setFullYear(S.getFullYear()+1):S.setMonth(S.getMonth()+1);const V=S.toISOString().split("T")[0];y(Q=>({...Q,contract_end:V}))}},[m.billing_period,m.contract_start]),n.useEffect(()=>{K()},[]);const a=async()=>{try{c(!0),$(null);const{data:t,error:S}=await u.from("user_profiles").select("id, email, full_name").eq("is_active",!0).order("full_name");if(S)throw S;console.log("✅ Users loaded:",(t==null?void 0:t.length)||0),g(t||[])}catch(t){console.error("Error fetching users:",t),$(`Erro ao carregar usuários: ${t.message}`)}finally{c(!1)}},r=async()=>{try{te(!0),$(null);const{data:t,error:S}=await u.from("supplier_contracts").select("id, supplier_name, supplier_email, contract_type").eq("is_active",!0).order("supplier_name");if(S)throw S;console.log("✅ Suppliers loaded:",(t==null?void 0:t.length)||0),Z(t||[])}catch(t){console.error("Error fetching suppliers:",t),$(`Erro ao carregar fornecedores: ${t.message}`)}finally{te(!1)}},i=async(t,S)=>{try{if(l(t),$(null),S.type!=="application/pdf")throw new Error("Apenas arquivos PDF são permitidos");if(S.size>10*1024*1024)throw new Error("Arquivo muito grande. Máximo 10MB permitido");const V=Date.now(),Q=Math.random().toString(36).substring(2,15),X=`client-contracts/${V}-${Q}.pdf`,{data:re,error:fe}=await u.storage.from("client-contracts").upload(X,S);if(fe)throw new Error(`Erro no upload: ${fe.message}`);const{data:Ne}=u.storage.from("client-contracts").getPublicUrl(X);if(!(Ne!=null&&Ne.publicUrl))throw new Error("Erro ao obter URL do arquivo");const{error:Ue}=await u.from("client_contracts").update({contract_file_url:Ne.publicUrl}).eq("id",t);if(Ue)throw await u.storage.from("client-contracts").remove([X]),Ue;C("Contrato anexado com sucesso!"),K()}catch(V){console.error("Upload error:",V),$(V.message||"Erro ao fazer upload do arquivo")}finally{l(null)}},H=async t=>{t.preventDefault();try{if($(null),!m.user_id)throw new Error("Selecione um usuário para criar o contrato.");const S=new Date(m.contract_start);let V=new Date(S);m.billing_period==="semiannual"?V.setMonth(V.getMonth()+6):m.billing_period==="annual"?V.setFullYear(V.getFullYear()+1):V.setMonth(V.getMonth()+1);const Q={user_id:m.user_id,plan_type:m.plan_type,billing_period:m.billing_period,monthly_value:m.monthly_value,leverage_multiplier:m.leverage_multiplier,contract_start:m.contract_start,contract_end:V.toISOString().split("T")[0],is_active:!0,referral_partner_id:m.referral_partner_id||null},{error:X}=await u.from("client_contracts").insert(Q);if(X)throw X;const{error:re}=await u.from("user_profiles").update({contracted_plan:m.plan_type,plan_status:"active",plan_start_date:m.contract_start,plan_end_date:V.toISOString().split("T")[0],current_leverage:m.leverage_multiplier}).eq("id",m.user_id);re&&console.warn("Warning updating user profile:",re),C("Contrato criado com sucesso!"),A(!1),y({user_id:"",plan_type:"bitcoin",billing_period:"monthly",monthly_value:0,leverage_multiplier:1,referral_partner_id:"",contract_start:new Date().toISOString().split("T")[0],contract_end:""}),K()}catch(S){$(S.message)}},de=async t=>{if(confirm("Tem certeza que deseja excluir o arquivo do contrato?"))try{$(null);const S=x.find(re=>re.id===t);if(!(S!=null&&S.contract_file_url)){$("Nenhum arquivo encontrado para excluir");return}const Q=new URL(S.contract_file_url).pathname.split("/").pop();if(Q){const{error:re}=await u.storage.from("client-contracts").remove([`client-contracts/${Q}`]);re&&console.warn("Warning deleting file:",re)}const{error:X}=await u.from("client_contracts").update({contract_file_url:null}).eq("id",t);if(X)throw X;C("Arquivo do contrato excluído com sucesso!"),K()}catch(S){console.error("Delete file error:",S),$(S.message||"Erro ao excluir arquivo do contrato")}},K=async()=>{try{const{data:t,error:S}=await u.from("client_contracts").select(`
          *,
          user_profiles (
            email,
            full_name,
            phone
          )
        `).order("created_at",{ascending:!1});if(S)throw S;T(t||[])}catch(t){console.error("Erro ao buscar contratos:",t)}finally{L(!1)}},Ce=t=>{k(t.id),j(t)},ke=async()=>{if(b)try{const{error:t}=await u.from("client_contracts").update(M).eq("id",b);if(t)throw t;await K(),k(null),j({})}catch(t){console.error("Erro ao atualizar contrato:",t)}},ge=()=>{k(null),j({})},Le=t=>{z(t),N(!0)},je=async()=>{if(!(!d||!F.trim()))try{const{error:t}=await u.from("client_contracts").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",d.id);if(t)throw t;await K(),N(!1),z(null),f("")}catch(t){console.error("Erro ao cancelar contrato:",t)}},ue=async()=>{if(!(!w||!Y.trim()))try{const{error:t}=await u.from("client_contracts").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",w.id);if(t)throw t;const{error:S}=await u.from("user_profiles").update({contracted_plan:"none",plan_status:"inactive",current_leverage:1}).eq("id",w.user_id);S&&console.warn("Warning updating user profile:",S),C("Contrato revogado com sucesso!"),await K(),R(!1),G(null),O("")}catch(t){$(t.message)}},ye=async()=>{if(U)try{if(U.contract_file_url){const Q=new URL(U.contract_file_url).pathname.split("/").pop();Q&&await u.storage.from("client-contracts").remove([`client-contracts/${Q}`])}const{error:t}=await u.from("client_contracts").delete().eq("id",U.id);if(t)throw t;const{error:S}=await u.from("user_profiles").update({contracted_plan:"none",plan_status:"inactive",current_leverage:1}).eq("id",U.user_id);S&&console.warn("Warning updating user profile:",S),C("Contrato excluído permanentemente!"),await K(),W(!1),o(null)}catch(t){$(t.message)}},Ze=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),Re=t=>new Date(t).toLocaleDateString("pt-BR"),et=t=>({bitcoin:"Bitcoin","mini-indice":"Mini Índice","mini-dolar":"Mini Dólar","portfolio-completo":"Portfólio Completo"})[t]||t,tt=t=>({monthly:"Mensal",semiannual:"Semestral",annual:"Anual"})[t]||t;if(h)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const st=x.filter(t=>t.is_active),Se=x.filter(t=>!t.is_active),ve=x.length,at=ve>0?Se.length/ve*100:0,De=new Date;De.setDate(De.getDate()-30);const rt=Se.filter(t=>new Date(t.updated_at)>=De),lt=ve>0?rt.length/ve*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Contratos Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:st.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Contratos Cancelados"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:Se.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Taxa de Churn Total"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[at.toFixed(1),"%"]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Churn Mensal (30d)"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[lt.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("button",{onClick:()=>A(!0),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),"Criar Contrato"]})}),_&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 mr-2"}),_,e.jsx("button",{onClick:()=>$(null),className:"ml-auto text-red-500 hover:text-red-700",children:"×"})]}),p&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),p,e.jsx("button",{onClick:()=>C(null),className:"ml-auto text-green-500 hover:text-green-700",children:"×"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contratos de Clientes"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome do Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Plano"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Alavancagem"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Período"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contrato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(t=>{var S,V,Q;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:((S=t.user_profiles)==null?void 0:S.email)||"Email não encontrado"}),e.jsxs("div",{className:"text-gray-500 text-xs",children:["ID: ",t.user_id.substring(0,8),"..."]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:((V=t.user_profiles)==null?void 0:V.full_name)||"Nome não cadastrado"}),((Q=t.user_profiles)==null?void 0:Q.phone)&&e.jsx("div",{className:"text-gray-500 text-xs",children:t.user_profiles.phone})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:b===t.id?e.jsxs("select",{value:M.plan_type||"",onChange:X=>j({...M,plan_type:X.target.value}),className:"text-sm border rounded px-2 py-1",children:[e.jsx("option",{value:"bitcoin",children:"Bitcoin"}),e.jsx("option",{value:"mini-indice",children:"Mini Índice"}),e.jsx("option",{value:"mini-dolar",children:"Mini Dólar"}),e.jsx("option",{value:"portfolio-completo",children:"Portfólio Completo"})]}):e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:et(t.plan_type)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b===t.id?e.jsx("input",{type:"number",value:M.monthly_value||"",onChange:X=>j({...M,monthly_value:parseFloat(X.target.value)}),className:"text-sm border rounded px-2 py-1 w-24"}):e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:Ze(t.monthly_value)}),e.jsx("div",{className:"text-gray-500 text-xs",children:tt(t.billing_period)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b===t.id?e.jsx("input",{type:"number",min:"1",max:"100",value:M.leverage_multiplier||"",onChange:X=>j({...M,leverage_multiplier:parseInt(X.target.value)}),className:"text-sm border rounded px-2 py-1 w-16"}):e.jsxs("span",{className:"font-medium",children:[t.leverage_multiplier,"x"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{children:[e.jsx("div",{children:Re(t.contract_start)}),e.jsxs("div",{className:"text-gray-500",children:["até ",Re(t.contract_end)]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t.is_active?"Ativo":"Cancelado"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[t.contract_file_url?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:t.contract_file_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-blue-600 hover:text-blue-800 text-sm",children:[e.jsx(Xe,{className:"h-4 w-4"}),"Ver PDF"]}),e.jsx("button",{onClick:()=>de(t.id),className:"text-red-600 hover:text-red-800 text-xs",title:"Excluir arquivo do contrato",children:"Excluir"})]}):e.jsx("span",{className:"text-sm text-gray-500",children:"Não anexado"}),e.jsxs("label",{className:"cursor-pointer",children:[e.jsx("input",{type:"file",accept:".pdf",onChange:X=>{var fe;const re=(fe=X.target.files)==null?void 0:fe[0];re&&i(t.id,re)},className:"hidden"}),e.jsx("div",{className:"flex items-center gap-1 px-2 py-1 text-xs bg-blue-600 hover:bg-blue-700 text-white rounded transition-colors",children:s===t.id?e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"h-3 w-3"}),e.jsx("span",{children:"Anexar PDF"})]})})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsx("div",{className:"flex items-center space-x-2",children:b===t.id?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:ke,className:"text-green-600 hover:text-green-900",title:"Salvar alterações",children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:ge,className:"text-gray-600 hover:text-gray-900",title:"Cancelar edição",children:e.jsx(se,{className:"h-4 w-4"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>Ce(t),className:"text-blue-600 hover:text-blue-900",title:"Editar contrato",children:e.jsx(pt,{className:"h-4 w-4"})}),t.is_active&&e.jsx("button",{onClick:()=>Le(t),className:"text-orange-600 hover:text-orange-900",title:"Cancelar contrato",children:e.jsx(yt,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{G(t),R(!0)},className:"text-orange-600 hover:text-orange-900",title:"Revogar contrato (desativar mas manter histórico)",children:e.jsx(We,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{o(t),W(!0)},className:"text-red-600 hover:text-red-900",title:"Excluir contrato permanentemente",children:e.jsx(pe,{className:"h-4 w-4"})})]})})})]},t.id)})})]})}),x.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(me,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum contrato encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Comece criando seu primeiro contrato de cliente"}),e.jsxs("button",{onClick:()=>A(!0),className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),"Criar Primeiro Contrato"]})]})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Cancelar Contrato"}),e.jsx("button",{onClick:()=>N(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-5 w-5"})})]}),e.jsxs("p",{className:"text-gray-600 mb-4",children:["Tem certeza que deseja cancelar o contrato de"," ",e.jsx("strong",{children:((Ae=d==null?void 0:d.user_profiles)==null?void 0:Ae.full_name)||"usuário"}),"?"]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo do cancelamento *"}),e.jsx("textarea",{value:F,onChange:t=>f(t.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm",rows:3,placeholder:"Descreva o motivo do cancelamento...",required:!0})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>N(!1),className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",children:"Cancelar"}),e.jsx("button",{onClick:je,disabled:!F.trim(),className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirmar Cancelamento"})]})]})}),q&&w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Revogar Contrato"}),e.jsx("button",{onClick:()=>R(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(We,{className:"h-5 w-5 text-orange-600 mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-orange-800 text-sm font-medium",children:["Revogar contrato de ",(Te=w.user_profiles)==null?void 0:Te.full_name]}),e.jsx("p",{className:"text-orange-700 text-xs",children:"O contrato será desativado mas mantido no histórico"})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo da Revogação *"}),e.jsx("textarea",{value:Y,onChange:t=>O(t.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Descreva o motivo da revogação...",rows:4,required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ue,disabled:!Y.trim(),className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white px-4 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Confirmar Revogação"}),e.jsx("button",{onClick:()=>R(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})}),B&&U&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Excluir Contrato"}),e.jsx("button",{onClick:()=>W(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(pe,{className:"h-5 w-5 text-red-600 mr-2"}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-red-800 text-sm font-medium",children:["Excluir permanentemente o contrato de ",($e=U.user_profiles)==null?void 0:$e.full_name]}),e.jsx("p",{className:"text-red-700 text-xs",children:"⚠️ Esta ação não pode ser desfeita! O contrato será removido completamente."})]})]})}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-yellow-900 mb-2",children:"Consequências da Exclusão:"}),e.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsx("li",{children:"• Contrato será removido permanentemente do banco de dados"}),e.jsx("li",{children:'• Plano do usuário será resetado para "none"'}),e.jsx("li",{children:"• Alavancagem será resetada para 1x"}),e.jsx("li",{children:"• Histórico de pagamentos será perdido"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:ye,className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Confirmar Exclusão"}),e.jsx("button",{onClick:()=>W(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Criar Novo Contrato"}),e.jsx("button",{onClick:()=>A(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:H,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Selecionar Cliente *"}),ee&&e.jsx("div",{className:"text-sm text-blue-600 mb-2",children:"Carregando usuários..."}),e.jsxs("select",{value:m.user_id,onChange:t=>y({...m,user_id:t.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:ee,required:!0,children:[e.jsx("option",{value:"",children:ee?"Carregando usuários...":"Selecione um usuário"}),ee?e.jsx("option",{disabled:!0,children:"Aguarde..."}):I.map(t=>e.jsxs("option",{value:t.id,children:[t.full_name||"Nome não informado"," (",t.email,") - ID: ",t.id.substring(0,8),"..."]},t.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:I.length>0?`${I.length} usuários disponíveis`:"Nenhum usuário encontrado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Plano *"}),e.jsxs("select",{value:m.plan_type,onChange:t=>y({...m,plan_type:t.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"bitcoin",children:"Bitcoin"}),e.jsx("option",{value:"mini-indice",children:"Mini Índice"}),e.jsx("option",{value:"mini-dolar",children:"Mini Dólar"}),e.jsx("option",{value:"portfolio-completo",children:"Portfólio Completo"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Período de Cobrança *"}),e.jsxs("select",{value:m.billing_period,onChange:t=>y({...m,billing_period:t.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"monthly",children:"Mensal"}),e.jsx("option",{value:"semiannual",children:"Semestral"}),e.jsx("option",{value:"annual",children:"Anual"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Mensal (R$) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:m.monthly_value,onChange:t=>y({...m,monthly_value:parseFloat(t.target.value)||0}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"0.00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Multiplicador de Alavancagem *"}),e.jsx("input",{type:"number",min:"1",max:"100",value:m.leverage_multiplier,onChange:t=>y({...m,leverage_multiplier:parseInt(t.target.value)||1}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Parceiro de Indicação (Opcional)"}),E&&e.jsx("div",{className:"text-sm text-blue-600 mb-2",children:"Carregando fornecedores..."}),e.jsxs("select",{value:m.referral_partner_id,onChange:t=>y({...m,referral_partner_id:t.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:E,children:[e.jsx("option",{value:"",children:E?"Carregando fornecedores...":"Nenhum parceiro (indicação direta)"}),D.map(t=>e.jsxs("option",{value:t.id,children:[t.supplier_name," (",t.supplier_email,") - ",t.contract_type]},t.id))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:D.length>0?`${D.length} parceiros disponíveis`:"Nenhum fornecedor ativo encontrado"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Data de Fim do Contrato",m.billing_period==="monthly"?" (calculado automaticamente)":" (calculado automaticamente) *"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:m.contract_end,className:"w-full px-4 py-3 border border-gray-300 rounded-lg bg-blue-50 text-gray-700",readOnly:!0}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(ne,{className:"h-5 w-5 text-blue-500"})})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Data calculada automaticamente: ",m.billing_period==="semiannual"?"+6 meses":m.billing_period==="annual"?"+1 ano":"+1 mês"," da data de início"]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Informações do Contrato"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("p",{children:"• O contrato será criado para o usuário com o email informado"}),e.jsx("p",{children:"• A data de fim será calculada automaticamente baseada no período"}),e.jsx("p",{children:"• O perfil do usuário será atualizado com o plano contratado"}),e.jsx("p",{children:"• A alavancagem será aplicada automaticamente"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Criar Contrato"}),e.jsx("button",{type:"button",onClick:()=>A(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})})]})},Et=()=>{const[x,T]=n.useState([]),[h,L]=n.useState(!0),[b,k]=n.useState(null),[M,j]=n.useState(null),[v,N]=n.useState(null),[d,z]=n.useState({}),[F,f]=n.useState(!1),[q,R]=n.useState({email:"",phone:"",full_name:"",is_active:!0});n.useState(!0),n.useEffect(()=>{w()},[]);const w=async()=>{var o;try{L(!0),k(null),console.log("🔍 Fetching users via admin edge function...");const{data:{user:s},error:l}=await u.auth.getUser();if(l){console.error("❌ Auth error:",l),k("Erro de autenticação");return}if(!s||s.email!=="pedropardal04@gmail.com"){k("Acesso negado. Apenas administradores podem ver a lista de usuários.");return}console.log("✅ Admin access verified for:",s.email);const _=await fetch("https://relrptuovgglkpnxxmrx.supabase.co/functions/v1/admin-users?action=list",{method:"GET",headers:{Authorization:`Bearer ${(o=(await u.auth.getSession()).data.session)==null?void 0:o.access_token}`,"Content-Type":"application/json"}});if(!_.ok)throw new Error(`HTTP ${_.status}: ${_.statusText}`);const $=await _.json();if($.success&&$.users)console.log("✅ Users loaded from edge function:",$.users.length),T($.users),$.users.length===0&&k('Nenhum usuário encontrado no sistema. Clique em "Sincronizar Usuários" para buscar usuários do sistema de autenticação.');else throw new Error($.error||"Erro ao carregar usuários")}catch(s){console.error("Error fetching users:",s),k(`Erro ao carregar usuários: ${s.message}`),T([])}finally{L(!1)}},G=o=>{N(o.id),console.log("🔧 Editing user:",o.email,"Current values:",{plan:o.contracted_plan,leverage:o.current_leverage||o.leverage_multiplier,active:o.is_active}),z({full_name:o.full_name||"",phone:o.phone||"",current_leverage:Number(o.current_leverage||o.leverage_multiplier||1),contracted_plan:o.contracted_plan||"none",plan_status:o.plan_status||"inactive",is_active:o.is_active!==!1}),k(null),j(null)},Y=async()=>{if(v)try{k(null);const o=x.find($=>$.id===v);console.log("💾 Saving user edit for:",o==null?void 0:o.email),console.log("📝 Form data:",d);const s={updated_at:new Date().toISOString()};d.full_name!==void 0&&(s.full_name=d.full_name||""),d.phone!==void 0&&(s.phone=d.phone||null),d.current_leverage!==void 0&&(s.current_leverage=Number(d.current_leverage)||1,s.leverage_multiplier=Number(d.current_leverage)||1),d.contracted_plan!==void 0&&(s.contracted_plan=d.contracted_plan,s.plan_status=d.contracted_plan&&d.contracted_plan!=="none"?"active":"inactive"),d.is_active!==void 0&&(s.is_active=d.is_active),console.log("📤 Sending update:",s);const{data:l,error:_}=await u.from("user_profiles").update(s).eq("id",v).select();if(_)throw console.error("❌ Update error:",_),_;console.log("✅ Update successful:",l),j("Usuário atualizado com sucesso!"),N(null),z({}),await w()}catch(o){console.error("❌ Error saving user edit:",o),k(o.message)}},O=()=>{N(null),z({}),k(null),j(null)},B=async o=>{if(confirm("Tem certeza que deseja excluir este usuário? Esta ação não pode ser desfeita."))try{const{error:s}=await u.from("user_profiles").delete().eq("id",o);if(s&&!s.message.includes("No rows found"))throw s;const{error:l}=await u.auth.admin.deleteUser(o);l&&console.warn("Warning deleting auth user:",l),j("Usuário excluído com sucesso!"),w()}catch(s){k(s.message)}},W=async()=>{var o;try{L(!0),k(null),j(null),console.log("🔄 Sincronizando usuários...");const s=await fetch("https://relrptuovgglkpnxxmrx.supabase.co/functions/v1/admin-users?action=sync",{method:"POST",headers:{Authorization:`Bearer ${(o=(await u.auth.getSession()).data.session)==null?void 0:o.access_token}`,"Content-Type":"application/json"}});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);const l=await s.json();if(l.success)j(l.message||"Sincronização concluída com sucesso!"),await w();else throw new Error(l.error||"Erro na sincronização")}catch(s){console.error("Sync error:",s),k(s.message)}finally{L(!1)}},U=async o=>{var s;o.preventDefault();try{k(null);const l=await fetch("https://relrptuovgglkpnxxmrx.supabase.co/functions/v1/admin-users?action=create",{method:"POST",headers:{Authorization:`Bearer ${(s=(await u.auth.getSession()).data.session)==null?void 0:s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({email:q.email,phone:q.phone,full_name:q.full_name,is_active:q.is_active})});if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);const _=await l.json();if(_.success)j(_.message||"Usuário criado com sucesso!");else throw new Error(_.error||"Erro ao criar usuário");f(!1),R({email:"",phone:"",full_name:"",is_active:!0}),await w()}catch(l){console.error("Error creating user:",l),k(l.message)}};return h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-12 w-12 text-blue-600 mr-4"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Central de Usuários"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie perfis de usuários e contratos"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:W,disabled:h,className:"flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ae,{className:"w-4 h-4"}),h?"Sincronizando...":"Sincronizar Usuários"]}),e.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),"Novo Usuário"]})]})]})}),b&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 mr-2"}),b,e.jsx("button",{onClick:()=>k(null),className:"ml-auto text-red-500 hover:text-red-700",children:"×"})]}),M&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),M,e.jsx("button",{onClick:()=>j(null),className:"ml-auto text-green-500 hover:text-green-700",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Usuários"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:x.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Usuários Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:x.filter(o=>o.is_active).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ht,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Com Contratos"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:x.filter(o=>o.contracted_plan&&o.contracted_plan!=="none").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Novos (30 dias)"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:x.filter(o=>{const s=new Date;return s.setDate(s.getDate()-30),new Date(o.created_at)>s}).length})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Lista de Usuários"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gerencie perfis, contratos e configurações dos usuários"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nome do Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Último Login"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Criado em"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(o=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:v===o.id?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Y,className:"text-green-600 hover:text-green-900",title:"Salvar alterações",children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:O,className:"text-gray-600 hover:text-gray-900",title:"Cancelar edição",children:e.jsx(se,{className:"h-4 w-4"})})]}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G(o),className:"text-blue-600 hover:text-blue-900",title:"Editar usuário",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(o.id),className:"text-red-600 hover:text-red-900",title:"Excluir usuário",children:e.jsx(pe,{className:"h-4 w-4"})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-blue-600 font-medium",children:(o.full_name||o.email).charAt(0).toUpperCase()})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm text-gray-500",children:o.email}),e.jsxs("div",{className:"text-xs text-gray-400",children:["ID: ",o.id.substring(0,8),"..."]})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:v===o.id?e.jsx("input",{type:"text",value:d.full_name||"",onChange:s=>z({...d,full_name:s.target.value}),className:"text-sm font-medium text-gray-900 border border-gray-300 rounded px-2 py-1 min-w-[150px]",placeholder:"Nome completo"}):e.jsx("div",{className:"text-sm font-medium text-gray-900",children:o.full_name||"Nome não informado"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:v===o.id?e.jsx("input",{type:"tel",value:d.phone||"",onChange:s=>z({...d,phone:s.target.value}),className:"text-sm text-gray-900 border border-gray-300 rounded px-2 py-1 min-w-[140px]",placeholder:"(11) 99999-9999"}):e.jsx("div",{className:"space-y-1",children:o.phone?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-sm text-gray-900 font-medium",children:o.phone}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>window.open(`https://wa.me/55${o.phone.replace(/\D/g,"")}?text=Olá, sou do Quant Broker e estou aqui para te ajudar com seu portfólio de IA. Como posso ajudar?`,"_blank"),className:"inline-flex items-center gap-1 text-xs text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 px-2 py-1 rounded transition-colors",children:[e.jsx(Me,{className:"h-3 w-3"}),"WhatsApp"]})})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"Não informado"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.email_confirmed_at?e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-900 font-medium",children:new Date(o.email_confirmed_at).toLocaleDateString("pt-BR")}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(o.email_confirmed_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}):e.jsx("span",{className:"text-gray-400 italic",children:"Email não confirmado"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:v===o.id?e.jsxs("select",{value:d.is_active?"active":"inactive",onChange:s=>z({...d,is_active:s.target.value==="active"}),className:"text-sm border border-gray-300 rounded px-2 py-1 min-w-[80px]",children:[e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"})]}):e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${o.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:o.is_active?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.created_at?new Date(o.created_at).toLocaleDateString("pt-BR"):"N/A"})]},o.id))})]})}),x.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ae,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum usuário encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Os usuários cadastrados aparecerão aqui"}),e.jsxs("button",{onClick:W,className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(ae,{className:"w-4 h-4"}),"Sincronizar Usuários do Auth"]})]})]}),F&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Novo Usuário"}),e.jsx("button",{onClick:()=>f(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:U,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ke,{className:"h-4 w-4 inline mr-1"}),"Email *"]}),e.jsx("input",{type:"email",value:q.email,onChange:o=>R({...q,email:o.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"usuario@email.com",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(nt,{className:"h-4 w-4 inline mr-1"}),"Telefone"]}),e.jsx("input",{type:"tel",value:q.phone,onChange:o=>R({...q,phone:o.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),e.jsx("input",{type:"text",value:q.full_name,onChange:o=>R({...q,full_name:o.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Nome do usuário"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:q.is_active?"active":"inactive",onChange:o=>R({...q,is_active:o.target.value==="active"}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"})]})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"Informações sobre a tabela user_profiles"}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Conectada à tabela de autenticação via foreign key"}),e.jsx("li",{children:"• Planos e alavancagem gerenciados via contratos"}),e.jsx("li",{children:"• Policies de segurança configuradas"}),e.jsx("li",{children:"• Triggers automáticos para atualizações"})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Nota:"}),' O usuário será criado com a senha temporária "TempPassword123!" e deverá alterá-la no primeiro login.']})}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Criar Usuário"}),e.jsx("button",{type:"button",onClick:()=>f(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})})]})})},Ft=()=>e.jsxs("div",{className:"admin-users-panel",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Central de Usuários"}),e.jsx("p",{className:"text-gray-600",children:"Gerencie perfis de usuários e contratos"})]}),e.jsx(Et,{})]}),Mt=()=>{const[x,T]=n.useState([]),[h,L]=n.useState([]),[b,k]=n.useState(!0),[M,j]=n.useState(null),[v,N]=n.useState(null),[d,z]=n.useState(null),[F,f]=n.useState({});n.useEffect(()=>{q()},[]);const q=async()=>{try{k(!0),await Promise.all([R(),w()])}catch(s){console.error("Error fetching data:",s),j("Erro ao carregar dados")}finally{k(!1)}},R=async()=>{try{const{data:s,error:l}=await u.from("waitlist_entries").select("*").order("created_at",{ascending:!1});if(l)throw l;T(s||[])}catch(s){console.error("Error fetching waitlist:",s)}},w=async()=>{try{const{data:s,error:l}=await u.from("portfolio_offers").select("*").order("portfolio_type");if(l)throw l;L(s||[])}catch(s){console.error("Error fetching offers:",s)}},G=async(s,l)=>{try{const{error:_}=await u.from("waitlist_entries").update({status:l}).eq("id",s);if(_)throw _;N("Status atualizado com sucesso!"),R()}catch(_){j(_.message)}},Y=async s=>{if(confirm("Tem certeza que deseja excluir esta entrada?"))try{const{error:l}=await u.from("waitlist_entries").delete().eq("id",s);if(l)throw l;N("Entrada excluída com sucesso!"),R()}catch(l){j(l.message)}},O=s=>{z(s.id),f({is_available:s.is_available,stripe_link:s.stripe_link,button_text:s.button_text})},B=async()=>{if(d)try{const{error:s}=await u.from("portfolio_offers").update(F).eq("id",d);if(s)throw s;N("Oferta atualizada com sucesso!"),z(null),f({}),w()}catch(s){j(s.message)}},W=()=>{z(null),f({}),j(null),N(null)},U=s=>({bitcoin:"Bitcoin","mini-indice":"Mini Índice","mini-dolar":"Mini Dólar","portfolio-completo":"Portfólio Completo"})[s]||s,o=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"contacted":return"bg-blue-100 text-blue-800";case"converted":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return b?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(be,{className:"h-12 w-12 text-orange-600 mr-4"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestão de Fila de Espera"}),e.jsx("p",{className:"text-gray-600",children:"Controle de inscrições e configuração de ofertas"})]})]})}),M&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 mr-2"}),M,e.jsx("button",{onClick:()=>j(null),className:"ml-auto text-red-500 hover:text-red-700",children:"×"})]}),v&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),v,e.jsx("button",{onClick:()=>N(null),className:"ml-auto text-green-500 hover:text-green-700",children:"×"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm mb-8",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Configuração de Ofertas"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure se cada portfólio está disponível para venda ou em fila de espera"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Portfólio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Link Stripe"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Texto do Botão"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm font-medium text-gray-900",children:U(s.portfolio_type)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d===s.id?e.jsxs("select",{value:F.is_available?"available":"waitlist",onChange:l=>f({...F,is_available:l.target.value==="available"}),className:"text-sm border border-gray-300 rounded px-2 py-1",children:[e.jsx("option",{value:"available",children:"Disponível"}),e.jsx("option",{value:"waitlist",children:"Fila de Espera"})]}):e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.is_available?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"}`,children:s.is_available?"Disponível":"Fila de Espera"})}),e.jsx("td",{className:"px-6 py-4",children:d===s.id?e.jsx("input",{type:"url",value:F.stripe_link||"",onChange:l=>f({...F,stripe_link:l.target.value}),className:"w-full text-sm border border-gray-300 rounded px-2 py-1",placeholder:"https://buy.stripe.com/..."}):e.jsx("div",{className:"text-sm text-gray-900 max-w-[200px] truncate",children:s.stripe_link?e.jsxs("a",{href:s.stripe_link,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center",children:[e.jsx(Ye,{className:"h-3 w-3 mr-1"}),"Link Stripe"]}):e.jsx("span",{className:"text-gray-400",children:"Sem link"})})}),e.jsx("td",{className:"px-6 py-4",children:d===s.id?e.jsx("input",{type:"text",value:F.button_text||"",onChange:l=>f({...F,button_text:l.target.value}),className:"w-full text-sm border border-gray-300 rounded px-2 py-1",placeholder:"Texto do botão"}):e.jsx("span",{className:"text-sm text-gray-900",children:s.button_text})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d===s.id?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:B,className:"text-green-600 hover:text-green-800",title:"Salvar",children:e.jsx(qe,{className:"h-4 w-4"})}),e.jsx("button",{onClick:W,className:"text-gray-600 hover:text-gray-800",title:"Cancelar",children:e.jsx(se,{className:"h-4 w-4"})})]}):e.jsx("button",{onClick:()=>O(s),className:"text-blue-600 hover:text-blue-800",title:"Editar oferta",children:e.jsx(_e,{className:"h-4 w-4"})})})]},s.id))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Fila de Espera"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[x.length," inscrições na fila de espera"]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"h-5 w-5 text-gray-400"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[x.filter(s=>s.status==="pending").length," pendentes"]})]})})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Portfólio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capital"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.full_name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email}),e.jsx("div",{className:"text-sm text-gray-500",children:s.phone})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:U(s.portfolio_type)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.capital_available||"Não informado"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.created_at).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:s.status,onChange:l=>G(s.id,l.target.value),className:`text-xs px-2 py-1 rounded-full border-0 ${o(s.status)}`,children:[e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"contacted",children:"Contatado"}),e.jsx("option",{value:"converted",children:"Convertido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>window.open(`https://wa.me/55${s.phone.replace(/\D/g,"")}`,"_blank"),className:"text-green-600 hover:text-green-800",title:"Contatar via WhatsApp",children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>Y(s.id),className:"text-red-600 hover:text-red-800",title:"Excluir entrada",children:e.jsx(pe,{className:"h-4 w-4"})})]})})]},s.id))})]})}),x.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(be,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma inscrição na fila"}),e.jsx("p",{className:"text-gray-600",children:"As inscrições na fila de espera aparecerão aqui"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mt-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total na Fila"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:x.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(be,{className:"h-8 w-8 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendentes"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:x.filter(s=>s.status==="pending").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Convertidos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:x.filter(s=>s.status==="converted").length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ye,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taxa Conversão"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[x.length>0?Math.round(x.filter(s=>s.status==="converted").length/x.length*100):0,"%"]})]})]})})]})]})})},qt=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"h-8 w-8 text-blue-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Formulários de Consultoria"}),e.jsx("p",{className:"text-gray-600",children:"Funcionalidade em desenvolvimento"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Formulários de Consultoria"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Esta funcionalidade será implementada em breve"})]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ne,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Formulários de Consultoria"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Esta funcionalidade será implementada quando a tabela consultation_forms for criada no banco de dados."}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 text-blue-600 mr-2"}),e.jsx("p",{className:"text-sm text-blue-800",children:"Para ativar esta funcionalidade, crie a tabela consultation_forms no Supabase."})]})}),e.jsxs("button",{onClick:()=>window.open("https://wa.me/5511975333355","_blank"),className:"mt-4 inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(Me,{className:"h-4 w-4"}),"Contato WhatsApp"]})]})]})]}),Lt=()=>e.jsxs("div",{className:"admin-waitlist-panel space-y-8",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Fila de Espera & Formulários"}),e.jsx("p",{className:"text-gray-600",children:"Controle de inscrições, ofertas e formulários de consultoria"})]}),e.jsx(Mt,{}),e.jsx("div",{className:"border-t border-gray-200 pt-8",children:e.jsx(qt,{})})]}),Rt=()=>{const[x,T]=n.useState([]);n.useState(!1);const[h,L]=n.useState(null),b=n.useRef({}),[k,M]=n.useState(!0),[j,v]=n.useState(null),[N,d]=n.useState(null),[z,F]=n.useState(!1),[f,q]=n.useState(null),[R,w]=n.useState(!1),[G,Y]=n.useState(null),[O,B]=n.useState("");n.useEffect(()=>{W()},[]);const W=async()=>{var a;try{const i=await(await fetch("https://relrptuovgglkpnxxmrx.supabase.co/functions/v1/create-storage-bucket",{method:"POST",headers:{Authorization:`Bearer ${(a=(await u.auth.getSession()).data.session)==null?void 0:a.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({action:"setup"})})).json();i.success?console.log("Storage buckets initialized:",i.results):console.warn("Storage setup warning:",i.error)}catch(r){console.warn("Storage initialization warning:",r)}},U=a=>{const r=b.current[a];r&&r.click()},o=async(a,r)=>{var de;const i=(de=a.target.files)==null?void 0:de[0];if(!i)return;if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(i.type)){v("Apenas arquivos PDF, DOC e DOCX são permitidos");return}if(i.size>10*1024*1024){v("Arquivo muito grande. Máximo 10MB permitido");return}try{L(r),v(null);const K=Date.now(),Ce=Math.random().toString(36).substring(2,15),ke=i.name.split(".").pop(),ge=`supplier-contracts/${K}-${Ce}.${ke}`,{data:Le,error:je}=await u.storage.from("supplier-contracts").upload(ge,i);if(je)throw new Error(`Erro no upload: ${je.message}`);const{data:ue}=u.storage.from("supplier-contracts").getPublicUrl(ge);if(!(ue!=null&&ue.publicUrl))throw new Error("Erro ao obter URL do arquivo");const{error:ye}=await u.from("supplier_contracts").update({contract_file_url:ue.publicUrl}).eq("id",r);if(ye)throw await u.storage.from("supplier-contracts").remove([ge]),ye;d("Contrato anexado com sucesso!"),C()}catch(K){console.error("Upload error:",K),v(K.message||"Erro ao fazer upload do arquivo")}finally{L(null),b.current[r]&&(b.current[r].value="")}},s=async a=>{if(confirm("Tem certeza que deseja excluir o arquivo do contrato?"))try{v(null);const r=x.find(K=>K.id===a);if(!(r!=null&&r.contract_file_url)){v("Nenhum arquivo encontrado para excluir");return}const H=new URL(r.contract_file_url).pathname.split("/").pop();if(H){const{error:K}=await u.storage.from("supplier-contracts").remove([`supplier-contracts/${H}`]);K&&console.warn("Warning deleting file:",K)}const{error:de}=await u.from("supplier_contracts").update({contract_file_url:null}).eq("id",a);if(de)throw de;d("Arquivo do contrato excluído com sucesso!"),C()}catch(r){console.error("Delete file error:",r),v(r.message||"Erro ao excluir arquivo do contrato")}},[l,_]=n.useState({supplier_name:"",supplier_email:"",supplier_phone:"",contract_type:"tecnologia",service_description:"",monthly_value:0,contract_start:new Date().toISOString().split("T")[0],contract_end:"",payment_frequency:"monthly",auto_renewal:!1});n.useEffect(()=>{if(l.payment_frequency==="monthly"||l.payment_frequency==="quarterly")_(a=>({...a,contract_end:""}));else if(l.contract_start&&(l.payment_frequency==="semiannual"||l.payment_frequency==="annual")){const a=new Date(l.contract_start);let r=new Date(a);l.payment_frequency==="semiannual"?r.setMonth(r.getMonth()+6):l.payment_frequency==="annual"&&r.setFullYear(r.getFullYear()+1);const i=r.toISOString().split("T")[0];_(H=>({...H,contract_end:i}))}},[l.payment_frequency,l.contract_start]);const[$,p]=n.useState({});n.useEffect(()=>{C()},[]);const C=async()=>{try{M(!0);const{data:a,error:r}=await u.from("supplier_contracts").select("*").order("created_at",{ascending:!1});if(r)throw r;T(a||[])}catch(a){v(a.message)}finally{M(!1)}},P=async a=>{a.preventDefault();try{v(null);const r={supplier_name:l.supplier_name,supplier_email:l.supplier_email,supplier_phone:l.supplier_phone,contract_type:l.contract_type,service_description:l.service_description,monthly_value:l.monthly_value,contract_start:l.contract_start,contract_end:l.contract_end||null,payment_frequency:l.payment_frequency,auto_renewal:l.auto_renewal,is_active:!0},{error:i}=await u.from("supplier_contracts").insert(r);if(i)throw i;d("Contrato de fornecedor adicionado com sucesso!"),F(!1),_({supplier_name:"",supplier_email:"",supplier_phone:"",contract_type:"tecnologia",service_description:"",monthly_value:0,contract_start:new Date().toISOString().split("T")[0],contract_end:"",payment_frequency:"monthly",auto_renewal:!1}),C()}catch(r){v(r.message)}},A=async()=>{if(!G||!O.trim()){v("Motivo do cancelamento é obrigatório");return}try{const{error:a}=await u.from("supplier_contracts").update({is_active:!1,cancellation_reason:O,cancelled_at:new Date().toISOString()}).eq("id",G);if(a)throw a;d("Contrato cancelado com sucesso!"),w(!1),Y(null),B(""),C()}catch(a){v(a.message)}},m=async a=>{try{const{error:r}=await u.from("supplier_contracts").update({is_active:!0,cancellation_reason:null,cancelled_at:null}).eq("id",a);if(r)throw r;d("Contrato reativado com sucesso!"),C()}catch(r){v(r.message)}},y=a=>({tecnologia:"Tecnologia",marketing:"Marketing",operacional:"Operacional",juridico:"Jurídico",contabil:"Contábil",consultoria:"Consultoria",infraestrutura:"Infraestrutura",outros:"Outros"})[a]||a,I=a=>({monthly:"Mensal",quarterly:"Trimestral",semiannual:"Semestral",annual:"Anual"})[a]||a,g=x.filter(a=>a.is_active),D=x.filter(a=>!a.is_active),Z=g.reduce((a,r)=>a+r.monthly_value,0),ee=Z*12,c=x.length>0?D.length/x.length*100:0,E=g.reduce((a,r)=>(a[r.contract_type]=(a[r.contract_type]||0)+1,a),{}),te=g.reduce((a,r)=>(a[r.contract_type]=(a[r.contract_type]||0)+r.monthly_value,a),{});return k?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"h-12 w-12 text-purple-600 mr-4"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Contratos de Fornecedores"}),e.jsx("p",{className:"text-gray-600",children:"Gestão completa de contratos e fornecedores"})]})]}),e.jsxs("button",{onClick:()=>F(!0),className:"flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),"Novo Contrato de Fornecedor"]})]})}),j&&e.jsxs("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 mr-2"}),j,e.jsx("button",{onClick:()=>v(null),className:"ml-auto text-red-500 hover:text-red-700",children:"×"})]}),N&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),N,e.jsx("button",{onClick:()=>d(null),className:"ml-auto text-green-500 hover:text-green-700",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(me,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Fornecedores Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:g.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Gasto Mensal"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",Z.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Gasto Anual"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",ee.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"h-8 w-8 text-red-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Taxa Cancelamento"}),e.jsxs("p",{className:"text-2xl font-bold text-red-600",children:[c.toFixed(1),"%"]})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Contratos por Categoria"}),e.jsx("div",{className:"space-y-3",children:Object.entries(E).map(([a,r])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700",children:y(a)}),e.jsx("span",{className:"font-semibold text-purple-600",children:r})]},a))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Gastos por Categoria"}),e.jsx("div",{className:"space-y-3",children:Object.entries(te).map(([a,r])=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700",children:y(a)}),e.jsxs("span",{className:"font-semibold text-green-600",children:["R$ ",r.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]},a))})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Contratos de Fornecedores"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gerencie todos os contratos com fornecedores e prestadores de serviços"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fornecedor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Serviço"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Período"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contrato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(a=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:a.supplier_name}),e.jsx("div",{className:"text-sm text-gray-500",children:a.supplier_email}),e.jsx("div",{className:"text-sm text-gray-500",children:a.supplier_phone})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:y(a.contract_type)}),e.jsx("div",{className:"text-sm text-gray-500 max-w-[200px] truncate",children:a.service_description})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["R$ ",a.monthly_value.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("div",{className:"text-sm text-gray-500",children:I(a.payment_frequency)})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:new Date(a.contract_start).toLocaleDateString("pt-BR")}),e.jsx("div",{className:"text-sm text-gray-500",children:a.contract_end?`até ${new Date(a.contract_end).toLocaleDateString("pt-BR")}`:"Sem prazo definido"}),a.auto_renewal&&e.jsx("div",{className:"text-xs text-blue-600",children:"Renovação automática"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${a.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:a.is_active?"Ativo":"Cancelado"}),!a.is_active&&a.cancelled_at&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:new Date(a.cancelled_at).toLocaleDateString("pt-BR")})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[a.contract_file_url?e.jsxs(e.Fragment,{children:[e.jsx("a",{href:a.contract_file_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 text-sm",children:"Ver Contrato"}),e.jsx("button",{onClick:()=>s(a.id),className:"text-red-600 hover:text-red-800 text-xs",title:"Excluir arquivo do contrato",children:"Excluir Arquivo"})]}):e.jsx("span",{className:"text-sm text-gray-500",children:"Não anexado"}),e.jsx("button",{onClick:()=>U(a.id),disabled:h===a.id,className:"flex items-center gap-1 px-2 py-1 text-xs bg-purple-600 hover:bg-purple-700 text-white rounded transition-colors disabled:opacity-50",title:"Anexar contrato",children:h===a.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"h-3 w-3"}),e.jsx("span",{children:"Anexar"})]})}),e.jsx("input",{ref:r=>b.current[a.id]=r,type:"file",accept:".pdf,.doc,.docx",onChange:r=>o(r,a.id),className:"hidden"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-xs text-gray-500",children:a.is_active?"Ativo":"Cancelado"}),e.jsx("button",{onClick:()=>{a.is_active?(Y(a.id),w(!0)):m(a.id)},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 ${a.is_active?"bg-green-600":"bg-gray-400"}`,title:a.is_active?"Cancelar contrato":"Reativar contrato",children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.is_active?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("button",{onClick:()=>{q(a.id),p(a)},className:"text-blue-600 hover:text-blue-800",title:"Editar contrato",children:e.jsx(_e,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>{confirm("Tem certeza que deseja excluir este contrato?")},className:"text-red-600 hover:text-red-800",title:"Excluir contrato",children:e.jsx(pe,{className:"h-4 w-4"})})]})})]},a.id))})]})}),x.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(me,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum contrato encontrado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Comece adicionando seu primeiro contrato de fornecedor"}),e.jsxs("button",{onClick:()=>F(!0),className:"inline-flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors",children:[e.jsx(he,{className:"w-4 h-4"}),"Adicionar Primeiro Contrato"]})]})]}),z&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Novo Contrato de Fornecedor"}),e.jsx("button",{onClick:()=>F(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:P,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Fornecedor *"}),e.jsx("input",{type:"text",value:l.supplier_name,onChange:a=>_({...l,supplier_name:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Nome da empresa ou pessoa",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email do Fornecedor *"}),e.jsx("input",{type:"email",value:l.supplier_email,onChange:a=>_({...l,supplier_email:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"contato@fornecedor.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone do Fornecedor"}),e.jsx("input",{type:"tel",value:l.supplier_phone,onChange:a=>_({...l,supplier_phone:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Contrato *"}),e.jsxs("select",{value:l.contract_type,onChange:a=>_({...l,contract_type:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"tecnologia",children:"Tecnologia"}),e.jsx("option",{value:"marketing",children:"Marketing"}),e.jsx("option",{value:"operacional",children:"Operacional"}),e.jsx("option",{value:"juridico",children:"Jurídico"}),e.jsx("option",{value:"contabil",children:"Contábil"}),e.jsx("option",{value:"consultoria",children:"Consultoria"}),e.jsx("option",{value:"infraestrutura",children:"Infraestrutura"}),e.jsx("option",{value:"outros",children:"Outros"})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descrição do Serviço *"}),e.jsx("textarea",{value:l.service_description,onChange:a=>_({...l,service_description:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Descreva os serviços prestados pelo fornecedor",rows:3,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Mensal (R$) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:l.monthly_value,onChange:a=>_({...l,monthly_value:parseFloat(a.target.value)||0}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"0.00",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Frequência de Pagamento *"}),e.jsxs("select",{value:l.payment_frequency,onChange:a=>_({...l,payment_frequency:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,children:[e.jsx("option",{value:"monthly",children:"Mensal"}),e.jsx("option",{value:"quarterly",children:"Trimestral"}),e.jsx("option",{value:"semiannual",children:"Semestral"}),e.jsx("option",{value:"annual",children:"Anual"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Início do Contrato *"}),e.jsx("input",{type:"date",value:l.contract_start,onChange:a=>_({...l,contract_start:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Fim do Contrato",l.payment_frequency==="monthly"||l.payment_frequency==="quarterly"?" (calculado automaticamente)":" (calculado automaticamente) *"]}),l.payment_frequency==="monthly"||l.payment_frequency==="quarterly"?e.jsxs("div",{className:"w-full px-4 py-3 bg-gray-100 border border-gray-300 rounded-lg text-gray-500 text-center",children:["Sem prazo definido - Renovação ",l.payment_frequency==="monthly"?"mensal":"trimestral"]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:l.contract_end,onChange:a=>_({...l,contract_end:a.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-blue-50",placeholder:"Data calculada automaticamente",required:!0,readOnly:!0}),e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(ne,{className:"h-5 w-5 text-blue-500"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:l.payment_frequency==="monthly"||l.payment_frequency==="quarterly"?"Contratos mensais e trimestrais são renovados automaticamente":`Data calculada automaticamente: ${l.payment_frequency==="semiannual"?"+6 meses":"+1 ano"} da data de início`})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:l.auto_renewal,onChange:a=>_({...l,auto_renewal:a.target.checked}),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Renovação automática"})]})})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"submit",className:"flex-1 bg-purple-600 hover:bg-purple-700 text-white px-4 py-3 rounded-lg transition-colors disabled:opacity-50",children:"Criar Contrato"}),e.jsx("button",{type:"button",onClick:()=>F(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})}),R&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Cancelar Contrato"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 text-orange-600 mr-2"}),e.jsx("p",{className:"text-orange-800 text-sm",children:"Esta ação marcará o contrato como cancelado. O contrato permanecerá no histórico."})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo do Cancelamento *"}),e.jsx("textarea",{value:O,onChange:a=>B(a.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Descreva o motivo do cancelamento...",rows:4,required:!0})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:A,className:"flex-1 bg-orange-600 hover:bg-orange-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Confirmar Cancelamento"}),e.jsx("button",{onClick:()=>w(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})})]})})},At=()=>e.jsxs("div",{className:"admin-suppliers-panel",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Contratos de Fornecedores"}),e.jsx("p",{className:"text-gray-600",children:"Gestão completa de contratos e fornecedores"})]}),e.jsx(Rt,{})]}),Tt=()=>{const[x,T]=n.useState([]),[h,L]=n.useState([]),[b,k]=n.useState(!0),[M,j]=n.useState(null),[v,N]=n.useState(null),[d,z]=n.useState(""),[F,f]=n.useState("all"),[q,R]=n.useState("all"),[w,G]=n.useState(new Set),[Y,O]=n.useState(!1),[B,W]=n.useState(""),[U,o]=n.useState(""),[s,l]=n.useState(!1);n.useEffect(()=>{_()},[]),n.useEffect(()=>{$()},[x,d,F,q]);const _=async()=>{try{k(!0),j(null);const[c,E,te]=await Promise.all([u.from("user_profiles").select("id, email, full_name, phone, created_at"),u.from("waitlist_entries").select("id, email, full_name, phone, portfolio_type, capital_available, status, created_at"),u.from("consultation_forms").select("id, email, full_name, phone, consultation_type, capital_available, created_at").catch(()=>({data:[],error:null}))]),a=[],r=new Set;c.data&&c.data.forEach(i=>{r.has(i.email.toLowerCase())||(r.add(i.email.toLowerCase()),a.push({id:i.id,email:i.email,full_name:i.full_name||"",phone:i.phone,source:"users",created_at:i.created_at}))}),E.data&&E.data.forEach(i=>{r.has(i.email.toLowerCase())||(r.add(i.email.toLowerCase()),a.push({id:i.id,email:i.email,full_name:i.full_name,phone:i.phone,source:"waitlist",portfolio_type:i.portfolio_type,capital_available:i.capital_available,status:i.status,created_at:i.created_at}))}),te.data&&te.data.forEach(i=>{r.has(i.email.toLowerCase())||(r.add(i.email.toLowerCase()),a.push({id:i.id,email:i.email,full_name:i.full_name,phone:i.phone,source:"consultation",capital_available:i.capital_available,created_at:i.created_at}))}),a.sort((i,H)=>new Date(H.created_at).getTime()-new Date(i.created_at).getTime()),T(a)}catch(c){console.error("Error fetching leads:",c),j(c.message)}finally{k(!1)}},$=()=>{let c=[...x];d&&(c=c.filter(E=>E.full_name.toLowerCase().includes(d.toLowerCase())||E.email.toLowerCase().includes(d.toLowerCase())||E.phone&&E.phone.includes(d))),F!=="all"&&(c=c.filter(E=>E.source===F)),q!=="all"&&(q==="contacted"?c=c.filter(E=>E.status==="contacted"):q==="pending"&&(c=c.filter(E=>!E.status||E.status==="pending"))),L(c)},p=c=>{const E=new Set(w);E.has(c)?E.delete(c):E.add(c),G(E)},C=()=>{w.size===h.length?G(new Set):G(new Set(h.map(c=>c.id)))},P=c=>({users:"Usuários Cadastrados",waitlist:"Fila de Espera",consultation:"Formulários Consultoria"})[c]||c,A=c=>({users:"bg-blue-100 text-blue-800",waitlist:"bg-orange-100 text-orange-800",consultation:"bg-purple-100 text-purple-800"})[c]||"bg-gray-100 text-gray-800",m=async()=>{if(!B.trim()||!U.trim()){j("Assunto e mensagem são obrigatórios");return}try{l(!0),j(null);const c=h.filter(E=>w.has(E.id));console.log("📧 Enviando emails para:",c.length,"leads"),console.log("📝 Assunto:",B),console.log("💬 Mensagem:",U),c.forEach(E=>{const te=U.replace(/{nome}/g,E.full_name||"Cliente");console.log(`📤 Email para ${E.email}:`,{subject:B,message:te})}),await new Promise(E=>setTimeout(E,2e3)),N(`Emails enviados com sucesso para ${c.length} leads!`),O(!1),G(new Set),W(""),o("")}catch(c){j(c.message||"Erro ao enviar emails")}finally{l(!1)}},y=()=>U?U.replace(/{nome}/g,"João Silva"):"";if(b)return e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});const I=x.length,g=x.filter(c=>c.source==="users").length,D=x.filter(c=>c.source==="waitlist").length,Z=x.filter(c=>c.source==="consultation").length,ee=x.filter(c=>{const E=new Date(c.created_at),te=new Date;return E.getMonth()===te.getMonth()&&E.getFullYear()===te.getFullYear()}).length;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(we,{className:"h-8 w-8 text-green-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Central de Leads"}),e.jsx("p",{className:"text-gray-600",children:"Leads únicos de todas as fontes (sem duplicação por email)"})]})]}),e.jsxs("button",{onClick:()=>O(!0),disabled:w.size===0,className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ee,{className:"w-4 h-4"}),"Email em Massa (",w.size,")"]})]}),M&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 mr-2"}),M,e.jsx("button",{onClick:()=>j(null),className:"ml-auto text-red-500 hover:text-red-700",children:"×"})]}),v&&e.jsxs("div",{className:"bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg flex items-center",children:[e.jsx(ie,{className:"h-5 w-5 mr-2"}),v,e.jsx("button",{onClick:()=>N(null),className:"ml-auto text-green-500 hover:text-green-700",children:"×"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total Leads Únicos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:I})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Usuários"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:g})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Fila de Espera"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:D})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Leads Este Mês"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:ee})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtros"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Buscar"}),e.jsx("input",{type:"text",value:d,onChange:c=>z(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Buscar por nome, email ou telefone..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fonte"}),e.jsxs("select",{value:F,onChange:c=>f(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todas as Fontes"}),e.jsx("option",{value:"users",children:"Usuários Cadastrados"}),e.jsx("option",{value:"waitlist",children:"Fila de Espera"}),e.jsx("option",{value:"consultation",children:"Formulários Consultoria"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:q,onChange:c=>R(c.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"pending",children:"Sem Contato"}),e.jsx("option",{value:"contacted",children:"Contatado"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Lista de Leads Únicos (",h.length," de ",I,")"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Todos os leads únicos por email, sem duplicação entre fontes"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.jsxs("button",{onClick:C,className:"flex items-center gap-2 hover:text-gray-700",children:[w.size===h.length&&h.length>0?e.jsx(Ge,{className:"h-4 w-4 text-blue-600"}):e.jsx(Ve,{className:"h-4 w-4"}),"Selecionar"]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Lead"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fonte"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Capital"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Detalhes"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Registro"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map(c=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>p(c.id),className:"flex items-center justify-center",children:w.has(c.id)?e.jsx(Ge,{className:"h-4 w-4 text-blue-600"}):e.jsx(Ve,{className:"h-4 w-4 text-gray-400 hover:text-gray-600"})})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold",children:(c.full_name||c.email).charAt(0).toUpperCase()}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:c.full_name||"Nome não informado"}),e.jsx("div",{className:"text-sm text-gray-500",children:c.email}),c.phone&&e.jsx("div",{className:"text-sm text-gray-500",children:c.phone})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-medium rounded-full ${A(c.source)}`,children:P(c.source)})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:c.capital_available||"Não informado"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:c.portfolio_type?e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["Interesse: ",c.portfolio_type]}),c.status&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Status: ",c.status]})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("select",{value:c.status||"pending",onChange:E=>{console.log("Updating status for",c.email,"to",E.target.value)},className:"text-xs px-2 py-1 border border-gray-300 rounded",children:[e.jsx("option",{value:"pending",children:"Sem Contato"}),e.jsx("option",{value:"contacted",children:"Contatado"}),e.jsx("option",{value:"converted",children:"Convertido"}),e.jsx("option",{value:"cancelled",children:"Cancelado"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(c.created_at).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>window.open(`mailto:${c.email}`,"_blank"),className:"text-blue-600 hover:text-blue-800",title:"Enviar email individual",children:e.jsx(Ke,{className:"h-4 w-4"})}),c.phone&&e.jsx("button",{onClick:()=>window.open(`https://wa.me/55${c.phone.replace(/\D/g,"")}`,"_blank"),className:"text-green-600 hover:text-green-800",title:"Contatar via WhatsApp",children:e.jsx(Ee,{className:"h-4 w-4"})})]})})]},c.id))})]})}),h.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(we,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhum lead encontrado"}),e.jsx("p",{className:"text-gray-600",children:"Os leads aparecerão aqui conforme forem sendo gerados"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Fonte"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx(ae,{className:"h-12 w-12 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:g}),e.jsx("div",{className:"text-sm text-gray-600",children:"Usuários Cadastrados"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[I>0?(g/I*100).toFixed(1):0,"% do total"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(be,{className:"h-12 w-12 text-orange-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:D}),e.jsx("div",{className:"text-sm text-gray-600",children:"Fila de Espera"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[I>0?(D/I*100).toFixed(1):0,"% do total"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx(ne,{className:"h-12 w-12 text-purple-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:Z}),e.jsx("div",{className:"text-sm text-gray-600",children:"Formulários Consultoria"}),e.jsxs("div",{className:"text-xs text-gray-500",children:[I>0?(Z/I*100).toFixed(1):0,"% do total"]})]})]})]}),Y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Email Marketing em Massa"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Enviando para ",w.size," leads selecionados"]})]}),e.jsx("button",{onClick:()=>O(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(se,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-blue-900 mb-2",children:["Leads Selecionados (",w.size,")"]}),e.jsx("div",{className:"max-h-32 overflow-y-auto",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm text-blue-800",children:h.filter(c=>w.has(c.id)).map(c=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-600 rounded-full flex items-center justify-center text-white text-xs mr-2",children:(c.full_name||c.email).charAt(0).toUpperCase()}),e.jsx("span",{children:c.full_name||c.email})]},c.id))})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assunto do Email *"}),e.jsx("input",{type:"text",value:B,onChange:c=>W(c.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: Oportunidade Exclusiva - Portfólios de IA",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mensagem do Email *"}),e.jsx("textarea",{value:U,onChange:c=>o(c.target.value),rows:12,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none",placeholder:`Olá {nome},

Espero que esteja bem! 

Tenho uma oportunidade exclusiva para você conhecer nossos Portfólios de IA Quant Broker...

Use {nome} para personalizar automaticamente com o nome do lead.

Atenciosamente,
Equipe Quant Broker`,required:!0}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Use ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"{nome}"})," para personalizar automaticamente"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Preview da Mensagem"}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 h-80 overflow-y-auto",children:e.jsxs("div",{className:"text-sm text-gray-700 whitespace-pre-wrap",children:[e.jsx("strong",{children:"Para:"})," joao.silva@email.com",e.jsx("br",{}),e.jsx("strong",{children:"Assunto:"})," ",B||"Assunto do email",e.jsx("br",{}),e.jsx("br",{}),y()||"Digite sua mensagem para ver o preview..."]})})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-semibold text-yellow-900 mb-2",children:"⚠️ Importante"}),e.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[e.jsx("li",{children:"• Esta é uma simulação - integre com provedor real de email"}),e.jsx("li",{children:"• Respeite as leis de LGPD e anti-spam"}),e.jsx("li",{children:"• Inclua sempre opção de descadastro"}),e.jsx("li",{children:"• Teste com poucos emails primeiro"})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:m,disabled:s||!B.trim()||!U.trim()||w.size===0,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white px-4 py-3 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Enviando Emails..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"h-5 w-5 mr-2"}),"Enviar para ",w.size," Leads"]})}),e.jsx("button",{onClick:()=>O(!1),className:"flex-1 bg-gray-600 hover:bg-gray-700 text-white px-4 py-3 rounded-lg transition-colors",children:"Cancelar"})]})]})]})})]})},$t=({activeTab:x})=>{const T=()=>{switch(x){case"financial":return e.jsx(He,{});case"contracts":return e.jsx(Dt,{});case"users":return e.jsx(Ft,{});case"waitlist":return e.jsx(Lt,{});case"suppliers":return e.jsx(At,{});case"leads":return e.jsx(Tt,{});default:return e.jsx(He,{})}};return e.jsx("div",{className:"admin-tab-content",children:T()})},Ut=()=>{const[x,T]=n.useState("financial");return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(vt,{}),e.jsx(Nt,{activeTab:x,onTabChange:T}),e.jsx($t,{activeTab:x})]})})},Ht=()=>e.jsx(it,{children:e.jsx(Ut,{})});export{Ht as default};
